{% extends 'layouts/base.njk' %}

{% if templateClass is not defined %}
  {% set templateClass = 'tmpl-product' %}
{% endif %}

{% block content %}
  <article class="product grid">

    <header class="product__header {%- if imgUrl %} mb-2 mb-lg-3{% endif %}">
      <!--
      {%- if date %}
        <div class="product__date-time mb-1">
          <time class="product__date text-muted font-sm" datetime="{{ date | dateStringISO }}">
            <span class="text-black">Published:</span>
            {{ date | dateFilter }}</time>
          <span class="font-bold" aria-hidden="true">&middot;</span>
          <span class="product__time text-muted font-sm">
            <span class="text-black">Read time:</span> About {{ content | readingTime }}</span>
        </div>
      {% endif %}
      -->

      <h1 class="product__title">{{ title }}</h1>

      {%- if subtitle %}
        <h2 class="product__subtitle">{{ subtitle }}</h2>
      {% endif %}
<!--
      {%- if tags %}
        {# https://stackoverflow.com/questions/66261187/11ty-how-to-display-product-tags-in-my-product-njk-file #}
        <ul class="tag__items display-flex">
          {% for tag in tags -%}
            {% if tag !== 'products' %}
              {% set tagUrl %}/tags/{{ tag }}/{% endset %}
              <li class="tag__item">
                <a class="tag__link" href="{{ tagUrl | url }}">#{{ tag }}</a>
              </li>
            {% endif %}
          {%- endfor %}
        </ul>
      {% endif %}
-->
    </header>

    {%- if imgUrl %}
      {% imageNjk imgUrl,
      imgAlt,
      imgSize,
      pictureClass,
      imgClass,
      imgBorderColor %}
    {% else %}
      <hr>
    {% endif %}

    <div class="product__content columns-1">
      {{ content | safe }}
      <a href="{{ productUrl }}">Get {{ title }} â†’</a>
    </div>

    {% if related %}
      <footer class="product__footer">

        {% set maxProducts = collections.products.length | min(2) %}

        <h2 class="related-products">Related {% if maxProducts == 1 %}product{% else %}products{% endif %}
        </h2>

        {% set productslist = collections.products | filterRelated(related) | head(-2) %}
        {% set productslistCounter = collections.products | length %}
        {% include "layouts/partials/products-list.njk" %}

      </footer>
    {% endif %}


    <!--
    <footer class="product__footer">
      <hr>
      <ul class="product__next-prev">
        {%- set nextproduct = collections.products | getNextCollectionItem(page) %}
        {%- if nextproduct %}
          <li class="product__next">
            <span class="product__next--label">
              {{ component('svg-icon', {
                svgWidth: 24,
                svgHeight: 24,
                svgClass: "product__next--icon",
                symbolId: "icon-chevron-left",
                screenReader: "Chevron left"
              }) }}
              Next
            </span>
            <a class="product__next--link" href="{{ nextproduct.url | url }}">
              {{ nextproduct.data.title }}
            </a>
          </li>
        {% endif %}
        {%- set previousproduct = collections.products | getPreviousCollectionItem(page) %}
        {%- if previousproduct %}
          <li class="product__prev{%- if not nextproduct %} ml-md-auto{% endif %}">
            <span class="product__prev--label">
              Previous
              {{ component('svg-icon', {
                svgWidth: 24,
                svgHeight: 24,
                svgClass: "product__prev--icon",
                symbolId: "icon-chevron-right",
                screenReader: "Chevron right"
              }) }}
            </span>
            <a class="product__prev--link" href="{{ previousproduct.url | url }}">
              {{ previousproduct.data.title }}
            </a>
          </li>
        {% endif %}
      </ul>
    </footer>
    -->

  </article>
{% endblock %}

{#
{% block js %}
  {% if page.url === '/products/mermaid_test/' %}
    <script src="{{ '/assets/scripts/vendors/mermaid.min.js' | url }}"></script>
    <script>
      mermaid.initialize({startOnLoad: true});
    </script>
  {% endif %}
{% endblock %}
#}
